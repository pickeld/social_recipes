{% extends "base.html" %}

{% block title %}Home - Social Recipes{% endblock %}

{% block content %}
<div class="main-container">
    <div class="header">
        <h1><i class="fas fa-utensils"></i> Social Recipes</h1>
        <p>Extract recipes from TikTok, YouTube, Instagram and more</p>
    </div>
    
    <div class="url-input-section">
        <div class="input-group">
            <input type="url" id="video-url" placeholder="Paste video URL here (TikTok, YouTube, Instagram...)" 
                   class="url-input">
            <button id="process-btn" class="btn btn-primary">
                <i class="fas fa-magic"></i>
                Extract Recipe
            </button>
        </div>
    </div>
    
    <div class="progress-section" id="progress-section" style="display: none;">
        <h2><i class="fas fa-tasks"></i> Processing Progress</h2>
        
        <div class="progress-bar-container">
            <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
            <span class="progress-text" id="progress-text">0%</span>
        </div>
        
        <div class="progress-steps">
            <div class="progress-step" id="step-info" data-stage="info">
                <div class="step-icon"><i class="fas fa-info-circle"></i></div>
                <div class="step-label">Get Info</div>
                <div class="step-status"></div>
            </div>
            <div class="progress-step" id="step-download" data-stage="download">
                <div class="step-icon"><i class="fas fa-download"></i></div>
                <div class="step-label">Download</div>
                <div class="step-status"></div>
            </div>
            <div class="progress-step" id="step-transcribe" data-stage="transcribe">
                <div class="step-icon"><i class="fas fa-microphone"></i></div>
                <div class="step-label">Transcribe</div>
                <div class="step-status"></div>
            </div>
            <div class="progress-step" id="step-visual" data-stage="visual">
                <div class="step-icon"><i class="fas fa-eye"></i></div>
                <div class="step-label">Visual Text</div>
                <div class="step-status"></div>
            </div>
            <div class="progress-step" id="step-image" data-stage="image">
                <div class="step-icon"><i class="fas fa-image"></i></div>
                <div class="step-label">Extract Image</div>
                <div class="step-status"></div>
            </div>
            <div class="progress-step" id="step-evaluate" data-stage="evaluate">
                <div class="step-icon"><i class="fas fa-robot"></i></div>
                <div class="step-label">AI Recipe</div>
                <div class="step-status"></div>
            </div>
            <div class="progress-step" id="step-upload" data-stage="upload">
                <div class="step-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                <div class="step-label">Upload</div>
                <div class="step-status"></div>
            </div>
        </div>
        
        <div class="log-container">
            <h3><i class="fas fa-terminal"></i> Activity Log</h3>
            <div class="log-output" id="log-output"></div>
        </div>
    </div>
    
    <div class="result-section" id="result-section" style="display: none;">
        <h2><i class="fas fa-check-circle"></i> Recipe Created!</h2>
        <div class="recipe-preview" id="recipe-preview"></div>
        <button id="new-recipe-btn" class="btn btn-secondary">
            <i class="fas fa-plus"></i>
            Process Another Video
        </button>
    </div>
</div>
{% endblock %}

{% block modals %}
<!-- Recipe Preview Modal -->
<div class="modal-overlay" id="preview-modal" style="display: none;">
    <div class="modal-container">
        <div class="modal-header">
            <h2><i class="fas fa-eye"></i> Recipe Preview</h2>
            <p class="modal-subtitle">Review before uploading to <span id="preview-target"></span></p>
        </div>
        
        <div class="modal-body">
            <div class="preview-image-section">
                <h4><i class="fas fa-image"></i> Select Dish Photo</h4>
                <p class="image-selection-hint">Click to select the best photo for your recipe (AI recommendation marked with <i class="fas fa-star"></i>)</p>
                
                <div class="preview-image-container" id="preview-image-container" style="display: none;">
                    <img id="preview-image" src="" alt="Selected dish photo">
                </div>
                
                <div class="image-candidates-grid" id="image-candidates-grid"></div>
            </div>
            
            <div class="preview-content">
                <h3 id="preview-title"></h3>
                <p id="preview-description"></p>
                
                <div class="preview-section">
                    <h4><i class="fas fa-list"></i> Ingredients</h4>
                    <ul id="preview-ingredients"></ul>
                </div>
                
                <div class="preview-section">
                    <h4><i class="fas fa-tasks"></i> Instructions</h4>
                    <ol id="preview-instructions"></ol>
                </div>
            </div>
        </div>
        
        <div class="modal-footer">
            <button id="cancel-upload-btn" class="btn btn-secondary">
                <i class="fas fa-times"></i>
                Cancel
            </button>
            <button id="confirm-upload-btn" class="btn btn-primary">
                <i class="fas fa-cloud-upload-alt"></i>
                Confirm Upload
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/main.js') }}?v=2"></script>
{% endblock %}
